{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://yourdomain.com/schemas/fortiplugin.schema.json",
  "title": "FortiPluginConfig",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[A-Z][a-zA-Z0-9]*$",
      "description": "Folder-style PascalCase: must start with a capital letter and contain only letters or digits"
    },
    "alias": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "kebab-case: lowercase letters, digits, hyphens; must start with a letter"
    },
    "description": {
      "type": "string"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version (e.g., 1.0.0)"
    },
    "providers": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[A-Z][A-Za-z0-9_\\\\]+$"
      },
      "description": "Fully-qualified class names to register as Laravel service providers"
    },
    "dependencies": {
      "type": "object",
      "description": "Map of package name -> dependency spec",
      "propertyNames": {
        "$ref": "#/definitions/DependencyName"
      },
      "additionalProperties": {
        "$ref": "#/definitions/DependencySpec"
      }
    },
    "hostConfig": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/HostConfig"
      }
    },
    "uiConfig": {
      "type": "object",
      "properties": {
        "routes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/UiRoute"
          }
        },
        "extend": {
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/UiRoute"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "routes": {
      "type": "object",
      "properties": {
        "dir": {
          "type": "string",
          "pattern": "^(?!.*\\.\\.)[A-Za-z0-9._/@-]+$",
          "description": "Relative path to the routes folder (e.g., \"routes\" or \"Resources/routes\"). '..' is not allowed."
        },
        "glob": {
          "type": "string",
          "description": "Glob for route files within dir (e.g., \"**/*.routes.json\").",
          "default": "**/*.routes.json"
        }
      },
      "required": [
        "dir"
      ],
      "additionalProperties": false
    },
    "main": {
      "$ref": "#/definitions/ExportDefinition"
    },
    "exports": {
      "type": "object",
      "propertyNames": {
        "$ref": "#/definitions/Slug"
      },
      "additionalProperties": {
        "$ref": "#/definitions/ExportDefinition"
      },
      "description": "Map of dashed-lowercase slugs to export definitions"
    }
  },
  "required": [
    "name",
    "alias",
    "description"
  ],
  "additionalProperties": false,
  "definitions": {
    "TriState": {
      "type": [
        "boolean",
        "null"
      ],
      "description": "Boolean or null (tri-state)"
    },
    "SettingValue": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        },
        {
          "type": "string"
        },
        {
          "type": "number"
        },
        {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/TriState"
          }
        }
      ],
      "description": "Allowed value types for settings (incl. arrays of strings, and maps of TriState)"
    },
    "Setting": {
      "type": "object",
      "properties": {
        "id": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "number"
            }
          ]
        }
      },
      "required": [
        "id"
      ],
      "additionalProperties": {
        "$ref": "#/definitions/SettingValue"
      },
      "description": "A single host setting; 'id' must be unique (enforced by installer/validator)"
    },
    "HostConfig": {
      "type": "object",
      "properties": {
        "global": {
          "type": "object",
          "properties": {
            "id": false
          },
          "additionalProperties": {
            "$ref": "#/definitions/SettingValue"
          },
          "description": "Defaults applied globally for the plugin (no 'id' allowed here)"
        },
        "settings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Setting"
          }
        }
      },
      "additionalProperties": false
    },
    "UiRoute": {
      "type": "object",
      "properties": {
        "href": {
          "type": "string"
        },
        "text": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "id": {
          "type": "string"
        }
      },
      "required": [
        "href",
        "text",
        "id"
      ],
      "additionalProperties": false
    },
    "Slug": {
      "type": "string",
      "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$",
      "description": "Dashed lowercase identifier (e.g., 'admin-panel')"
    },
    "ExportPath": {
      "type": "string",
      "pattern": "^(?!.*\\.\\.)[A-Za-z0-9._/@-]+$",
      "description": "Relative file path within the plugin (no '..')"
    },
    "ExportDefinitionObject": {
      "type": "object",
      "properties": {
        "file": {
          "$ref": "#/definitions/ExportPath"
        },
        "setting_id": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "number"
            }
          ]
        }
      },
      "required": [
        "file"
      ],
      "additionalProperties": false,
      "description": "Explicit export definition with optional binding to a HostConfig setting id"
    },
    "ExportDefinition": {
      "oneOf": [
        {
          "$ref": "#/definitions/ExportPath"
        },
        {
          "$ref": "#/definitions/ExportDefinitionObject"
        }
      ],
      "description": "Either a relative path string or an object with 'file' and optional 'setting_id'"
    },
    "DependencySource": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9._-]*$",
      "description": "Named source/registry (e.g., 'packagist', 'npm', 'git')"
    },
    "DependencyName": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9._-]*(/[a-z0-9][a-z0-9._-]*)*$",
      "maxLength": 128,
      "description": "Generic identifier (plugin/package). Either a slug (e.g., 'analytics-core') or namespaced with '/' (e.g., 'acme/analytics-core')."
    },
    "DependencySpec": {
      "oneOf": [
        {
          "type": "string",
          "description": "SemVer version requirement (e.g., ^1.2.0 or >=1.0.0)"
        },
        {
          "type": "object",
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+(-[0-9A-Za-z.-]+)?(\\+[0-9A-Za-z.-]+)?$",
              "description": "Semantic version (exact or with pre/build metadata). Hosts may allow ranges."
            },
            "source": {
              "$ref": "#/definitions/DependencySource"
            },
            "url": {
              "type": "string",
              "format": "uri"
            },
            "integrity": {
              "type": "string",
              "description": "Optional checksum/hash for verification (e.g., sha256-...)"
            },
            "notes": {
              "type": "string"
            }
          },
          "required": [
            "version"
          ],
          "anyOf": [
            {
              "required": [
                "source"
              ]
            },
            {
              "required": [
                "url"
              ]
            }
          ],
          "additionalProperties": false,
          "description": "Explicit dependency with version and a fetch hint (source and/or URL)"
        }
      ]
    }
  }
}